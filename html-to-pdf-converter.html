<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Advanced HTML to PDF Converter</title>
		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
		<style>
			.drop-zone {
				border: 2px dashed #ccc;
				border-radius: 6px;
				padding: 30px;
				text-align: center;
				color: #999;
				background-color: #f9f9f9;
				transition: background 0.2s;
			}

			.drop-zone.dragover {
				background-color: #e0f7fa;
				border-color: #00acc1;
				color: #007c91;
			}
		</style>
	</head>
	<body class="bg-light py-5">
		<div class="container bg-white p-4 rounded shadow" style="max-width: 850px">
			<h2 class="text-center mb-4">HTML to PDF Converter</h2>

			<div class="drop-zone mb-3" id="dropZone">
				Drag & drop an HTML file or paste text here
			</div>

			<div class="mb-3">
				<label for="htmlContent" class="form-label">HTML Content</label>
				<textarea
					class="form-control"
					id="htmlContent"
					rows="6"
					placeholder="Enter or drop your HTML here..."
				></textarea>
			</div>

			<div class="row g-3 mb-3">
				<div class="col-md-4">
					<label for="fileName" class="form-label">File Name</label>
					<input
						type="text"
						class="form-control"
						id="fileName"
						placeholder="e.g. MyFile"
					/>
				</div>
				<div class="col-md-4">
					<label for="format" class="form-label">Page Format</label>
					<select class="form-select" id="format">
						<option value="a4" selected>A4</option>
						<option value="letter">Letter</option>
						<option value="legal">Legal</option>
					</select>
				</div>
				<div class="col-md-4">
					<label for="orientation" class="form-label">Orientation</label>
					<select class="form-select" id="orientation">
						<option value="portrait" selected>Portrait</option>
						<option value="landscape">Landscape</option>
					</select>
				</div>
			</div>

			<div class="row g-3 mb-3">
				<div class="col-md-4">
					<label for="margin" class="form-label">Margin (inches)</label>
					<input
						type="number"
						class="form-control"
						id="margin"
						value="0.5"
						min="0"
						step="0.1"
					/>
				</div>
				<div class="col-md-4">
					<label for="scale" class="form-label">Render Scale (1-5)</label>
					<input
						type="number"
						class="form-control"
						id="scale"
						value="2"
						min="1"
						max="5"
						step="0.1"
					/>
				</div>
				<div class="col-md-4">
					<label for="quality" class="form-label">Image Quality (0-1)</label>
					<input
						type="number"
						class="form-control"
						id="quality"
						value="0.98"
						min="0.1"
						max="1"
						step="0.01"
					/>
				</div>
			</div>

			<div class="d-grid mb-3">
				<button class="btn btn-primary" onclick="convertToPDF()">
					Download PDF
				</button>
			</div>

			<div>
				<label class="form-label">Live Preview</label>
				<div
					id="preview"
					class="p-3 border rounded bg-light"
					style="min-height: 100px"
				>
					Preview will appear here...
				</div>
			</div>
		</div>

		<!-- JavaScript -->
		<script>
			function convertToPDF() {
				const htmlContent = document.getElementById("htmlContent").value;
				const fileName =
					document.getElementById("fileName").value || "document";
				const format = document.getElementById("format").value;
				const orientation = document.getElementById("orientation").value;
				const margin = parseFloat(document.getElementById("margin").value);
				const quality = parseFloat(document.getElementById("quality").value);
				const scale = parseFloat(document.getElementById("scale").value);

				const element = document.createElement("div");
				element.innerHTML = htmlContent;

				const opt = {
					margin: margin,
					filename: `${fileName}.pdf`,
					image: { type: "jpeg", quality: quality },
					html2canvas: { scale: scale },
					jsPDF: { unit: "in", format: format, orientation: orientation },
				};

				html2pdf().set(opt).from(element).save();
			}

			document
				.getElementById("htmlContent")
				.addEventListener("input", function () {
					document.getElementById("preview").innerHTML =
						this.value || "Preview will appear here...";
				});

			// Drag-and-drop functionality
			const dropZone = document.getElementById("dropZone");
			const textarea = document.getElementById("htmlContent");

			dropZone.addEventListener("dragover", (e) => {
				e.preventDefault();
				dropZone.classList.add("dragover");
			});

			dropZone.addEventListener("dragleave", () => {
				dropZone.classList.remove("dragover");
			});

			dropZone.addEventListener("drop", (e) => {
				e.preventDefault();
				dropZone.classList.remove("dragover");

				if (e.dataTransfer.files.length > 0) {
					const file = e.dataTransfer.files[0];
					if (file.type === "text/html" || file.name.endsWith(".html")) {
						const reader = new FileReader();
						reader.onload = function (event) {
							textarea.value = event.target.result;
							document.getElementById("preview").innerHTML = textarea.value;
						};
						reader.readAsText(file);
					} else {
						alert("Please drop a valid .html file.");
					}
				} else {
					const text = e.dataTransfer.getData("text");
					if (text) {
						textarea.value = text;
						document.getElementById("preview").innerHTML = text;
					}
				}
			});
		</script>
	</body>
</html>
