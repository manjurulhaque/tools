<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Quotations</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
/* ================= BASE ================= */
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: #f9fafb;
}

/* ================= NAV ================= */
nav {
  padding: 14px 18px;
  background: #111827;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 14px;
  flex-wrap: wrap;
}

#nav-title {
  font-size: 20px;
  font-weight: 700;
}

#nav-controls {
  margin-left: auto;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
}

nav input,
nav select,
nav button {
  padding: 6px 8px;
  border-radius: 6px;
  border: none;
  font-size: 14px;
}

nav button {
  cursor: pointer;
}

#count {
  font-size: 14px;
  opacity: .85;
}

/* ================= HEADER ================= */
#content-header {
  max-width: 900px;
  margin: 0 auto;
  padding: 16px 20px 8px;
}

#subtitle {
  font-size: 18px;
  font-weight: 600;
}

#breadcrumbs {
  margin-top: 8px;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.breadcrumb {
  background: #374151;
  color: #fff;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 12px;
  display: flex;
  gap: 6px;
}

.breadcrumb button {
  background: none;
  border: none;
  color: #fff;
  cursor: pointer;
}

/* ================= MAIN ================= */
main {
  max-width: 900px;
  margin: 0 auto;
  padding: 12px 20px 28px;
}

.card {
  position: relative;
  background: #fff;
  border-radius: 16px;
  padding: 20px 22px 18px;
  margin-bottom: 18px;
  border: 1px solid #e5e7eb;
  box-shadow: 0 8px 24px rgba(0,0,0,.04);
}

.card::before {
  content: "â€œ";
  position: absolute;
  top: 10px;
  left: 14px;
  font-size: 48px;
  color: #e5e7eb;
}

.quote {
  font-size: 17px;
  line-height: 1.65;
  padding-left: 18px;
}

.meta {
  margin-top: 16px;
  display: flex;
  gap: 10px;
}

.category-pill,
.author-chip {
  background: none;
  border: none;
  cursor: pointer;
  font-weight: 600;
  font-size: 12px;
}

.category-Wisdom { color:#5b21b6; }
.category-Science { color:#075985; }
.category-Technology { color:#166534; }
.category-Philosophy { color:#9a3412; }

.author-chip {
  margin-left: auto;
  font-size: 13px;
}

.no-results {
  opacity: .6;
  font-style: italic;
}

/* ================= PAGINATION ================= */
#pagination {
  display: flex;
  gap: 8px;
  justify-content: center;
  margin-bottom: 30px;
}

#pagination button {
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  background: #fff;
  cursor: pointer;
}

#pagination button[disabled] {
  opacity: .5;
  cursor: default;
}

/* ================= MOBILE ================= */
@media (max-width: 640px) {
  #nav-controls {
    width: 100%;
    justify-content: flex-end;
  }
}
</style>
</head>

<body>

<nav>
  <div id="nav-title">Quotations</div>

  <div id="nav-controls">
    <input id="search" placeholder="Searchâ€¦" aria-label="Search quotations">

    <select id="category" aria-label="Filter by category">
      <option value="">All categories</option>
    </select>

    <select id="author" aria-label="Filter by author">
      <option value="">All authors</option>
    </select>

    <select id="sort" aria-label="Sort quotations">
      <option value="text">Sort: Quote (Aâ€“Z)</option>
      <option value="author">Sort: Author (Aâ€“Z)</option>
      <option value="category">Sort: Category (Aâ€“Z)</option>
    </select>

    <button id="random" aria-label="Random quote">ðŸŽ² Random</button>

    <span id="count"></span>
  </div>
</nav>

<section id="content-header">
  <div id="subtitle"></div>
  <div id="breadcrumbs"></div>
</section>

<main id="list"></main>
<nav id="pagination" aria-label="Pagination"></nav>

<script>
/* ================= DATA ================= */
const QUOTATIONS = [
  { text:"The happiness of your life depends upon the quality of your thoughts.", author:"Marcus Aurelius", category:"Wisdom" },
  { text:"Life is like riding a bicycle. To keep your balance you must keep moving.", author:"Albert Einstein", category:"Science" },
  { text:"That brain of mine is something more than merely mortal; as time will show.", author:"Ada Lovelace", category:"Technology" },
  { text:"We can only see a short distance ahead, but we can see plenty there that needs to be done.", author:"Alan Turing", category:"Technology" },
  { text:"It does not matter how slowly you go as long as you do not stop.", author:"Confucius", category:"Philosophy" }
];

const items = [...QUOTATIONS];

/* ================= ELEMENTS ================= */
const list = document.getElementById("list");
const pagination = document.getElementById("pagination");
const searchInput = document.getElementById("search");
const categorySelect = document.getElementById("category");
const authorSelect = document.getElementById("author");
const sortSelect = document.getElementById("sort");
const countSpan = document.getElementById("count");
const subtitle = document.getElementById("subtitle");
const breadcrumbs = document.getElementById("breadcrumbs");
const randomBtn = document.getElementById("random");

/* ================= STATE ================= */
const PAGE_SIZE = 3;
let currentPage = 1;
const STORAGE_KEY = "quotation-filters";

/* ================= INIT FILTERS ================= */
[...new Set(items.map(i => i.category))]
  .forEach(c => categorySelect.add(new Option(c, c)));

[...new Set(items.map(i => i.author))]
  .forEach(a => authorSelect.add(new Option(a, a)));

/* ================= HEADER ================= */
function updateHeader() {
  const c = categorySelect.value;
  const a = authorSelect.value;

  subtitle.textContent =
    c && a ? `${c} Quotations by ${a}` :
    c ? `${c} Quotations` :
    a ? `Quotations by ${a}` :
    "All quotations";
}

/* ================= BREADCRUMBS ================= */
function makeCrumb(label, onRemove) {
  const d = document.createElement("div");
  d.className = "breadcrumb";
  d.innerHTML = `<span>${label}</span><button aria-label="Remove filter">âœ•</button>`;
  d.querySelector("button").onclick = onRemove;
  return d;
}

function updateBreadcrumbs() {
  breadcrumbs.innerHTML = "";

  if (categorySelect.value)
    breadcrumbs.appendChild(makeCrumb(
      `Category: ${categorySelect.value}`,
      () => { categorySelect.value=""; currentPage=1; applyFilters(); }
    ));

  if (authorSelect.value)
    breadcrumbs.appendChild(makeCrumb(
      `Author: ${authorSelect.value}`,
      () => { authorSelect.value=""; currentPage=1; applyFilters(); }
    ));

  if (searchInput.value)
    breadcrumbs.appendChild(makeCrumb(
      `Search: "${searchInput.value}"`,
      () => { searchInput.value=""; currentPage=1; applyFilters(); }
    ));
}

/* ================= URL + STORAGE ================= */
function readURL() {
  const p = new URLSearchParams(location.search);
  const stored = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");

  searchInput.value = p.get("search") ?? stored.search ?? "";
  categorySelect.value = p.get("category") ?? stored.category ?? "";
  authorSelect.value = p.get("author") ?? stored.author ?? "";
  sortSelect.value = p.get("sort") ?? stored.sort ?? "text";
}

function writeURL() {
  const p = new URLSearchParams();

  if (searchInput.value) p.set("search", searchInput.value);
  if (categorySelect.value) p.set("category", categorySelect.value);
  if (authorSelect.value) p.set("author", authorSelect.value);
  if (sortSelect.value !== "text") p.set("sort", sortSelect.value);

  history.replaceState(null, "", "?" + p.toString());

  localStorage.setItem(STORAGE_KEY, JSON.stringify({
    search: searchInput.value,
    category: categorySelect.value,
    author: authorSelect.value,
    sort: sortSelect.value
  }));
}

/* ================= RENDER ================= */
function render(filtered) {
  list.innerHTML = "";
  pagination.innerHTML = "";

  if (!filtered.length) {
    list.innerHTML = `<p class="no-results">No quotations found.</p>`;
    countSpan.textContent = "0 results";
    return;
  }

  const totalPages = Math.ceil(filtered.length / PAGE_SIZE);
  currentPage = Math.min(currentPage, totalPages);

  const start = (currentPage - 1) * PAGE_SIZE;
  const pageItems = filtered.slice(start, start + PAGE_SIZE);

  pageItems.forEach(i => {
    const safeCategory = i.category.replace(/\s+/g, "-");

    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="quote">${i.text}</div>
      <div class="meta">
        <button class="category-pill category-${safeCategory}">${i.category}</button>
        <button class="author-chip">${i.author}</button>
      </div>
    `;

    card.querySelector(".category-pill").onclick = () => {
      categorySelect.value = i.category;
      currentPage = 1;
      applyFilters();
    };

    card.querySelector(".author-chip").onclick = () => {
      authorSelect.value = i.author;
      currentPage = 1;
      applyFilters();
    };

    list.appendChild(card);
  });

  const prev = document.createElement("button");
  prev.textContent = "â† Prev";
  prev.disabled = currentPage === 1;
  prev.onclick = () => { currentPage--; applyFilters(); };

  const next = document.createElement("button");
  next.textContent = "Next â†’";
  next.disabled = currentPage === totalPages;
  next.onclick = () => { currentPage++; applyFilters(); };

  pagination.append(
    prev,
    Object.assign(document.createElement("span"), {
      textContent: `Page ${currentPage} of ${totalPages}`,
      style: "padding:6px 10px"
    }),
    next
  );

  countSpan.textContent = `${filtered.length} results`;
}

/* ================= FILTER + SORT ================= */
function applyFilters() {
  const term = searchInput.value.toLowerCase();

  let filtered = items.filter(i =>
    (!categorySelect.value || i.category === categorySelect.value) &&
    (!authorSelect.value || i.author === authorSelect.value) &&
    (!term ||
      i.text.toLowerCase().includes(term) ||
      i.author.toLowerCase().includes(term) ||
      i.category.toLowerCase().includes(term))
  );

  filtered.sort((a, b) =>
    String(a[sortSelect.value]).localeCompare(String(b[sortSelect.value]))
  );

  writeURL();
  updateHeader();
  updateBreadcrumbs();
  render(filtered);
}

/* ================= EVENTS ================= */
let debounce;
searchInput.addEventListener("input", () => {
  clearTimeout(debounce);
  debounce = setTimeout(() => {
    currentPage = 1;
    applyFilters();
  }, 200);
});

[categorySelect, authorSelect, sortSelect]
  .forEach(el => el.addEventListener("change", () => {
    currentPage = 1;
    applyFilters();
  }));

randomBtn.addEventListener("click", () => {
  const q = items[Math.floor(Math.random() * items.length)];
  subtitle.textContent = "Featured Quote";
  breadcrumbs.innerHTML = "";
  pagination.innerHTML = "";
  countSpan.textContent = "1 result";
  render([q]);
});

/* ================= INIT ================= */
readURL();
applyFilters();
</script>

</body>
</html>
