<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Advanced QR Code Generator</title>
		<!-- Bootstrap 5 CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<style>
			body {
				background-color: #f8f9fa;
			}
			#qrcode {
				margin-top: 20px;
				display: flex;
				justify-content: center;
			}
		</style>
	</head>
	<body>
		<div class="container my-5">
			<div class="card shadow">
				<div class="card-body">
					<h2 class="text-center mb-4">Advanced QR Code Generator</h2>

					<div class="row g-3">
						<div class="col-md-12">
							<label for="text" class="form-label">Enter Text or URL</label>
							<input
								type="text"
								class="form-control"
								id="text"
								placeholder="https://example.com"
							/>
						</div>

						<div class="col-md-6">
							<label for="size" class="form-label">Size (px)</label>
							<input type="number" class="form-control" id="size" value="300" />
						</div>

						<div class="col-md-6">
							<label for="margin" class="form-label">Margin</label>
							<input
								type="number"
								class="form-control"
								id="margin"
								value="10"
							/>
						</div>

						<div class="col-md-6">
							<label for="dotColor" class="form-label">Dot Color</label>
							<input
								type="color"
								class="form-control form-control-color"
								id="dotColor"
								value="#000000"
								title="Choose dot color"
							/>
						</div>

						<div class="col-md-6">
							<label for="bgColor" class="form-label">Background Color</label>
							<input
								type="color"
								class="form-control form-control-color"
								id="bgColor"
								value="#ffffff"
								title="Choose background color"
							/>
						</div>

						<div class="col-md-12">
							<label for="logo" class="form-label"
								>Upload Logo (Optional)</label
							>
							<input
								type="file"
								class="form-control"
								id="logo"
								accept="image/*"
							/>
						</div>
					</div>

					<div class="d-grid mt-4">
						<button class="btn btn-primary" id="generate-btn">
							Generate QR Code
						</button>
					</div>

					<div id="qrcode" class="my-4"></div>

					<div class="d-grid">
						<button
							class="btn btn-success"
							id="download-btn"
							style="display: none"
						>
							Download QR Code
						</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Bootstrap JS Bundle -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

		<!-- QR Code Styling Library -->
		<script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>

		<script>
			const qrCodeContainer = document.getElementById("qrcode");
			const generateBtn = document.getElementById("generate-btn");
			const downloadBtn = document.getElementById("download-btn");
			let qrCode;

			generateBtn.addEventListener("click", () => {
				const text =
					document.getElementById("text").value || "https://example.com";
				const size = parseInt(document.getElementById("size").value) || 300;
				const margin = parseInt(document.getElementById("margin").value) || 10;
				const dotColor = document.getElementById("dotColor").value;
				const bgColor = document.getElementById("bgColor").value;
				const logoFile = document.getElementById("logo").files[0];

				qrCodeContainer.innerHTML = "";

				const options = {
					width: size,
					height: size,
					data: text,
					image: "",
					margin: margin,
					dotsOptions: {
						color: dotColor,
						type: "rounded",
					},
					backgroundOptions: {
						color: bgColor,
					},
					imageOptions: {
						crossOrigin: "anonymous",
						margin: 5,
					},
				};

				const generateQR = (opts) => {
					qrCode = new QRCodeStyling(opts);
					qrCode.append(qrCodeContainer);
					downloadBtn.style.display = "block";
				};

				if (logoFile) {
					const reader = new FileReader();
					reader.onload = function (e) {
						options.image = e.target.result;
						generateQR(options);
					};
					reader.readAsDataURL(logoFile);
				} else {
					generateQR(options);
				}
			});

			downloadBtn.addEventListener("click", () => {
				if (qrCode) {
					qrCode.download({ name: "qr-code", extension: "png" });
				}
			});
		</script>
	</body>
</html>
